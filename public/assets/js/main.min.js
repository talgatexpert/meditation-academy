function fixHeaderPopup(){$(".js-header").hasClass("fixed")?(hideScroll(),$(".js-header").addClass("fixed-scroll")):hideScroll()}function hideScroll(){var e=document;e.body.classList.add("no-scroll"),e.scrollTop=window.pageYOffset,e.body.style.position="fixed",hasScrollbar()?e.body.style.width="calc(100% - "+getScrollbarSize()+"px)":e.body.style.width="100%",e.body.style.top=-e.scrollTop+"px"}function getScrollbarSize(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var a=document.createElement("div");a.style.width="100%",e.appendChild(a);var s=a.offsetWidth;return e.parentNode.removeChild(e),t-s}function hasScrollbar(){return document.body.scrollHeight>document.body.clientHeight}function showScroll(){var e=document;e.body.classList.remove("no-scroll"),e.body.style.position="",e.body.style.width="",e.body.style.top="",window.scroll(0,e.scrollTop),$(".js-header").removeClass("fixed-scroll")}function uuid(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var s=16*Math.random();return e>0?(s=(e+s)%16|0,e=Math.floor(e/16)):(s=(t+s)%16|0,t=Math.floor(t/16)),("x"===a?s:3&s|8).toString(16)})}$(function(){function e(e,t,a,s){return $.ajax({url:e,type:s,data:t,success:a})}svg4everybody(),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.extend({put:function(t,a,s){return e(t,a,s,"PUT")},delete:function(t,a,s){return e(t,a,s,"DELETE")}}),$(document).on("click",".js-ajax-reviews",function(e){e.preventDefault();let t=$(this),a=$(this).data("next-page");""!==a&&null!==a&&$.get(a).done(function(e){"OK"===e.status&&($(".js-ajax-reviews-load").append(e.reviews),t.data("next-page",e.next_page),null==e.next_page&&(t.data("next-page",""),t.hide()))}).fail(function(e){var t=$.parseJSON(e.responseText);alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),$(".js-subscribe").submit(function(e){e.preventDefault();let t=$(this).data("subscribe-url"),a=$(this).find("#email-subscribe").val();$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});let s=$(this).find("#email-subscribe");$.ajax({type:"POST",url:t,data:{email:a}}).done(function(e){s.val("")}).fail(function(e){var t=$.parseJSON(e.responseText);"ERROR"===t.status&&t.errors?(s.find(".field__input").removeClass("error"),s.find("label.error").remove(),$.each(t.errors,function(e,t){var a=a.addClass("error");$('<label class="error">'+t+"</label>").insertAfter(a)})):alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),$(".js-tag").on("click",function(e){e.preventDefault();var t=$(this).attr("href").substring(1);$('.js-article:not(".active")').fadeOut(0),$(this).hasClass("active")?($(this).removeClass("active"),$(".js-tag.active").length>0?$('.js-article[data-type="'+t+'"').removeClass("active").fadeOut(0):$(".js-article").removeClass("active").fadeIn()):($(this).addClass("active"),$('.js-article[data-type="'+t+'"').addClass("active").fadeIn(0))}),$(".js-hamb").on("click",function(){$(this).toggleClass("open"),$(".js-mobile-nav").toggleClass("open"),$(this).closest(".header").toggleClass("open"),$(this).hasClass("open")?fixHeaderPopup():showScroll()}),$('input[type="checkbox"], input[type="radio"]').styler(),$(document).on("change","input, textarea",function(){$(this).val()?$(this).addClass("value"):$(this).removeClass("value")}),$(".js-gallery-slider").owlCarousel({items:1,nav:!0,dots:!0,dotsEach:!0,loop:!0,margin:50,smartSpeed:550,autoplay:!1}),$(".js-classes-slider").owlCarousel({items:1,nav:!0,dots:!0,dotsEach:!0,loop:!0,margin:50,smartSpeed:550,autoplay:!1}),$(".js-team-slider").owlCarousel({items:1,nav:!0,dots:!0,dotsEach:!0,loop:!0,margin:100,smartSpeed:550,autoplay:!1}),$(".js-reviews-slider").owlCarousel({items:1,nav:!0,dots:!0,dotsEach:!0,loop:!0,margin:50,smartSpeed:550,autoplay:!1}),$(".js-interview-slider").owlCarousel({items:1,nav:!0,dots:!0,dotsEach:!0,loop:!0,margin:50,smartSpeed:550,autoplay:!1}),$(".js-valid").each(function(){$(this).validate({submitHandler:function(e){return!1}})}),$(".js-popup-ajax form").each(function(){var e=$(this);e.on("submit",function(t){t.preventDefault();var a=e.find("button[type=submit]");a.prop("disabled",!0),$.ajax({type:e.attr("method"),url:e.attr("action"),data:e.serialize()}).done(function(t){a.prop("disabled",!1),"OK"===t.status?t.redirect?window.location.replace(t.redirect):(e.parent(".js-popup").removeClass("open"),$("#popup-message .popup__title").html(t.popup.title),$("#popup-message .popup__text").html(t.popup.text),$(".popup-bg, #popup-message").addClass("open")):alert(t.message?t.message:"Случилась непредвиденная ошибка.")}).fail(function(t){a.prop("disabled",!1);var s=$.parseJSON(t.responseText);"ERROR"===s.status&&s.errors?(e.find(".field__input").removeClass("error"),e.find("label.error").remove(),$.each(s.errors,function(t,a){var s=e.find("input[name="+t+"]").addClass("error");$('<label class="error">'+a+"</label>").insertAfter(s)})):alert(s.message?s.message:"Случилась непредвиденная ошибка.")})}),e.on("reset",function(){e.find(".field__input").removeClass("error value"),e.find("label.error").remove()})}),$("#reasons .js-poll").click(function(e){e.preventDefault();var t=$(this);"yes"!==localStorage.getItem("poll-reasons")?$.post(t.closest(".reasons").data("poll-url"),{name:t.data("poll-name"),options:[t.data("poll-option")]}).always(function(e){"OK"===e.status&&localStorage.setItem("poll-reasons","yes"),window.location.href=t.attr("href")}):window.location.href=t.attr("href")});var t="";$(".js-change-avatar").on("click",function(){$(this).fadeOut(0),$(".js-avatars-dropdown").fadeIn(),t=$(".js-current-avatar img").attr("src")}),$(".js-avatars a").on("click",function(){var e=$(this).children("img").attr("src");$(".js-current-avatar img").attr("src",e)}),$(".js-save-avatar").on("click",function(){$(".js-current-avatar img").attr("src");$(".js-change-avatar").fadeIn(),$(".js-avatars-dropdown").fadeOut(0)}),$(".js-user-update").on("submit",function(e){e.preventDefault();let t=$(this),s=t.find(".js-current-avatar img").attr("src"),o=t.data("user-update-url"),r=t.find(".js-user-name").val(),n=t.find(".js-comment-visible"),i=n.is(":checked");$.post({url:o,data:{image:s,name:r,comment:i}}).done(function(e){"OK"===e.status&&($(".letters").length>0&&($(".letters").children().remove(),$(".letters").append(e.content),a.checkbox=e.visible,a.img=e.img,t.find(".js-comment-visible").prop("checked",e.visible),e.visible?n.addClass("checked"):n.addClass("remove")),$(".popup-bg, .js-popup").removeClass("open"),$(".js-popup-bg").removeClass("open"),$(".js-profile div").text(e.name),showScroll(),$(".js-change-avatar").fadeIn(),$(".js-avatars-dropdown").fadeOut(0))}).fail(function(e){var a=$.parseJSON(e.responseText);if("ERROR"===a.status&&a.errors)return t.find(".field__input").removeClass("error"),t.find("label.error").remove(),$.each(a.errors,function(e,a){var s=t.find("input[name="+e+"]").addClass("error");$('<label class="error">'+a+"</label>").insertAfter(s)}),hideScroll(),!1})}),$(".js-cancel-avatar").on("click",function(){$(".js-change-avatar").fadeIn(),$(".js-avatars-dropdown").fadeOut(0),$(".js-current-avatar img").attr("src",t)}),$(".js-registration").on("click",function(){$("#popup-registration form").trigger("reset"),$(".popup-bg, #popup-registration").addClass("open"),fixHeaderPopup()}),$(".js-profile").on("click",function(){$(".popup-bg, .js-popup-profile").addClass("open"),fixHeaderPopup()}),$(".js-call").on("click",function(){$("#popup-callback form").trigger("reset"),$(".popup-bg, #popup-callback").addClass("open"),fixHeaderPopup()}),$(document).on("click",".js-curator-comment-reply",function(e){e.preventDefault();let t=$(this).closest(".comment__info").find(".comment-curator-reply-form");t.find(".ck-reset").remove(),t.toggle(1,function(){let e=$(this).find("textarea").attr("id");ClassicEditor.create(document.querySelector(`#${e}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})})});let a={checkbox:$(".js-comment-visible").is("checked"),img:$(".js-current-avatar img").attr("src")};function s(e){var t=$(document).scrollTop();$(".js-anchors a").each(function(){var e=$(this),a=$(e.attr("href")),s=a.position().top;if(a.hasClass("section--white")&&(s-=200),s<=t&&s+a.height()>t){$(".js-anchors a").removeClass("active"),e.addClass("active");var o=$(".js-anchors a.active").attr("href");$(".screen").removeClass("active"),$(o).addClass("active")}})}$(".js-popup-bg").on("click",function(e){if($(e.target).closest(".js-popup").length)return;let t=$(".js-comment-visible"),s=$(".js-user-update").find(".js-user-name");$.get("/participant-get",function(e){"OK"===e.status&&(e.graduate&&1===$("#new-message").length&&$("html, body").animate({scrollTop:$("#new-message").offset().top},2e3),a.checkbox=e.visible,!0===a.checkbox?(t.prop("checked",!0),t.addClass("checked")):(t.prop("checked",!1),t.removeClass("checked")),s.val(e.name),s.addClass("value"))}),$(".js-current-avatar img").attr("src",a.img),$(".popup-bg, .js-popup").removeClass("open"),$(".js-user-update input").removeClass("error"),$(".js-user-update label.error").remove(),$(".js-change-avatar").fadeIn(),$(".js-avatars-dropdown").fadeOut(0),showScroll(),e.stopPropagation()}),$(".js-popup-close").on("click",function(){let e=$(".js-comment-visible"),t=$(".js-user-update").find(".js-user-name");$.get("/participant-get",function(s){"OK"===s.status&&(s.graduate&&1===$("#new-message").length&&$("html, body").animate({scrollTop:$("#new-message").offset().top},2e3),a.checkbox=s.visible,!0===a.checkbox?(e.prop("checked",!0),e.addClass("checked")):(e.prop("checked",!1),e.removeClass("checked")),t.val(s.name),t.addClass("value"))}),$(".js-user-update input").removeClass("error"),$(".js-user-update label.error").remove(),$(".js-change-avatar").fadeIn(),$(".js-avatars-dropdown").fadeOut(0),$(".js-current-avatar img").attr("src",a.img),showScroll(),$(".popup-bg, .js-popup").removeClass("open")}),$(window).scrollTop()>50&&$(".js-header").addClass("fixed"),$(window).on("scroll",function(){$(window).scrollTop()>50?$(".js-header").addClass("fixed"):$(".js-header").removeClass("fixed")}),$(".js-reason").on("click",function(){$(window).width()<768?($(".js-reason").not(this).find(".reason-info").slideUp(),$(this).find(".reason-info").slideDown()):($(".js-reason").removeClass("open").not(this).fadeTo(200,.3),$(this).addClass("open"))}),$(".js-reason").on("mouseenter",function(){$(".js-reason").not(this).fadeTo(200,.3),$(this).fadeTo(200,1)}),$(document).on("click",".js-accordion-link",function(){if($(this).toggleClass("open"),$(this).closest(".js-accordion").toggleClass("open").find(".js-accordion-drop").slideToggle(),$(this).hasClass("open")&&$(this).hasClass("item-letter__link"))$(this).find("span").text("Скрыть письмо");else{$(this).find("span").text("Показать письмо");var e=$(this).closest(".js-accordion").offset().top-$(".js-header").outerHeight();$("html, body").animate({scrollTop:e},"300")}}),$(document).on("click",".item-letter__link",function(){var e=$(this).closest(".letters__item");e.hasClass("new")&&$.ajax({type:"PATCH",url:e.data("read-url")}).done(function(t){if("OK"===t.status){if(e.removeClass("new"),e.find(".item-letter__status").remove(),t.hasOwnProperty("new_messages")){var a=$(".header__user .user__number");t.new_messages>0?a.html(t.new_messages):a.remove()}}else alert(t.message?t.message:"Случилась непредвиденная ошибка.")}).fail(function(e){var t=$.parseJSON(e.responseText);alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),$("[data-fancybox]").fancybox({afterShow:function(e,t){var a=t.$slide.find(this.src);a[0].play(),a.on("ended",function(){$.fancybox.close()})}}),$(".js-result").on("click",function(){$(this).toggleClass("open"),$(".js-result-hidden").fadeToggle()}),$(document).on("scroll",s),$(".js-anchors a").on("click",function(e){e.preventDefault(),$(document).off("scroll");var t=$(this).attr("href");$(".js-anchors a").removeClass("active"),$(t).addClass("active"),$(this).addClass("active");var a=this.hash;$target=$(a),scrollTop=0,$(t).hasClass("section--white")?scrollTop=$target.offset().top-200:scrollTop=$target.offset().top+2,$("html, body").stop().animate({scrollTop:scrollTop},500,"swing",function(){$(document).on("scroll",s)})}),$(window).scroll(function(){$(window).scrollTop()>715?$(".js-up").addClass("show"):$(".js-up").removeClass("show")}),$(".js-up").on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},"300")});var o=$("#audio-player").get(0);$(".step-info__audio .audio__btn").click(function(){o.paused?(o.play(),$(this).addClass("play")):(o.pause(),$(this).removeClass("play"))}),$(o).bind("timeupdate",function(){var e=Math.floor(this.currentTime/60);e=e>=10?e:"0"+e;var t=Math.floor(this.currentTime%60);t=t>=10?t:"0"+t,$(".step-info__audio .audio__current-time").text(e+":"+t),$(".step-info__audio .audio__progress").css("width",100*this.currentTime/this.duration+"%"),this.currentTime>=this.duration&&$(".step-info__audio .audio__btn").removeClass("play")}),$(".step-info__audio .audio__progress").click(function(e){var t=(e.pageX-$(this).offset().left)/$(this).outerWidth()*100;o.currentTime=t*o.duration/100}),$(document).on("submit","form.report-form",function(e){e.preventDefault();var t=$(this);const a=e=>{var a=t.find("button[type=submit]");const s=t.serialize()+e;a.prop("disabled",!0),$.ajax({type:t.attr("method"),url:t.attr("action"),data:s}).done(function(e){a.prop("disabled",!1),"OK"===e.status?(t.hide(),n.then(e=>{e.setData("")}).catch(e=>{console.error(e)}),$(".item-step__comments").data("last-id",e.lastId),$(".comments__amount").text(e.reportsCount),$(".comments__items").html(e.comments),$(".comments__more").css("display",e.showMore?"inline-flex":"none")):alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){a.prop("disabled",!1);var s=$.parseJSON(e.responseText);if("ERROR"===s.status&&s.errors){var o=t.find(".field__textarea").addClass("error");t.find("label.error").remove(),$('<label class="error">'+s.errors[Object.keys(s.errors)[0]]+"</label>").insertAfter(o)}else alert(s.message?s.message:"Случилась непредвиденная ошибка.")})};OneSignal.push(function(){OneSignal.isPushNotificationsEnabled(function(e){e?OneSignal.getUserId().then(e=>{a(e)}):OneSignal.push(function(){OneSignal.registerForPushNotifications().then(()=>{OneSignal.getUserId().then(e=>{a(e)}).catch(()=>{a("")})})})})})}),$(".comments__more").click(function(){var e=$(".item-step__comments");$.get(e.data("load-url"),{id:e.data("last-id"),step:e.data("step")}).done(function(t){"OK"===t.status?(e.data("last-id",t.lastId),$(".comments__amount").text(t.reportsCount),$(".comments__items").append(t.comments),$(".comments__more").css("display",t.showMore?"inline-flex":"none")):alert(t.message?t.message:"Случилась непредвиденная ошибка.")}).fail(function(e){var t=$.parseJSON(e.responseText);alert(t.message?t.message:"Случилась непредвиденная ошибка.")})});var r=null;$(".item-step__comments").on("click","a.comment-reply",function(){var e=$(this).closest(".comments__item"),t=e.find(".comment-reply-form form"),a=e.data("comment-id");t.find(".ck-reset").remove();let s=$(this);if(i&&($(".comment-edit-form").hide(),$(".comment-edit-form .field__textarea").val("").removeClass("error value"),$(".comment-edit-form label.error").remove(),i=null),r)if(a===r)t.find(".field__textarea").val("").removeClass("error value"),t.find("label.error").remove(),t.parent().hide(),r=null;else{$(".comment-reply-form").hide(),$(".comment-reply-form .field__textarea").val("").removeClass("error value"),$(".comment-reply-form label.error").remove(),t.parent().show();let e=t.find("textarea").attr("id");r=a,ClassicEditor.create(document.querySelector(`#${e}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})}else{let e=t.find("textarea").attr("id");t.parent().show(),r=a,ClassicEditor.create(document.querySelector(`#${e}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})}t.unbind("submit").submit(function(e){e.preventDefault();var a=t.find("button[type=submit]");a.prop("disabled",!0),$.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize()}).done(function(e){a.prop("disabled",!1),"OK"===e.status?(0===$(".comments__items").find("#report-"+e.reportId+"-comments").children().length?($("#report-"+e.reportId+"-comments").append(e.comment),s.closest(".comment").find(".comment-delete").remove(),s.closest(".comment").find(".comment-edit").remove()):$(".comments__items").find("#report-"+e.reportId+"-comments").length>0?$("#report-"+e.reportId+"-comments").append(e.comment):s.closest(".comment-block").append(e.comment),t.find(".field__textarea").val("").removeClass("error value"),t.find("label.error").remove(),t.parent().hide(),r=null):alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){a.prop("disabled",!1);var s=$.parseJSON(e.responseText);if("ERROR"===s.status&&s.errors){var o=t.find(".field__textarea").addClass("error");t.find("label.error").remove(),$('<label class="error">'+s.errors[Object.keys(s.errors)[0]]+"</label>").insertAfter(o)}else alert(s.message?s.message:"Случилась непредвиденная ошибка.")})})}),$(document).on("submit",".comment-curator-reply-form form",function(e){e.preventDefault();let t=$(this);var a=t.find("button[type=submit]");a.prop("disabled",!0),$.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize()}).done(function(e){t.unbind("submit"),a.prop("disabled",!1),"OK"===e.status?(0!==$("#report-"+e.reportId+"-comments").length?$("#report-"+e.reportId+"-comments").append(e.comment):$("[data-comment-id="+e.reportId+"]").after(e.comment),t.parent().hide(),t.find("textarea").val("").text("")):alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){a.prop("disabled",!1);var s=$.parseJSON(e.responseText);if("ERROR"===s.status&&s.errors){var o=t.find(".field__textarea").addClass("error");t.find("label.error").remove(),$('<label class="error">'+s.errors[Object.keys(s.errors)[0]]+"</label>").insertAfter(o)}else alert(s.message?s.message:"Случилась непредвиденная ошибка.")})});let n=null;if(1==$(".report-form").length){let e=$(".report-form").find("textarea").attr("id");n=ClassicEditor.create(document.querySelector(`#${e}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})}var i=null;$(".item-step__comments").on("click","a.comment-edit",function(){var e=$(this).closest(".comments__item"),t=e.find(".comment-edit-form form"),a=t.find(".field__textarea"),s=e.data("comment-id");let o=a.attr("id");r&&($(".comment-reply-form").hide(),$(".comment-reply-form .field__textarea").val("").removeClass("error value"),$(".comment-reply-form label.error").remove(),r=null),i?s===i?(t.find(".field__textarea").val("").removeClass("error value"),t.find("label.error").remove(),t.parent().hide(),i=null):($(".comment-edit-form").hide(),$(".comment-edit-form .field__textarea").val("").removeClass("error value"),$(".comment-edit-form label.error").remove(),a.val(e.find(".comment__text").html()).addClass("value"),t.parent().show(),i=s,ClassicEditor.create(document.querySelector(`#${o}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})):(a.val(e.find(".comment__text").html()).addClass("value"),t.find(".ck-reset").remove(),t.parent().show(),i=s,ClassicEditor.create(document.querySelector(`#${o}`),{language:"ru",toolbar:{items:["heading","|","bold","italic","|","bulletedList","numberedList","|","undo","redo","|","blockQuote","|","link"]}}).catch(e=>{console.error(e)})),t.unbind("submit").submit(function(s){s.preventDefault();var o=t.find("button[type=submit]");o.prop("disabled",!0),$.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize()}).done(function(a){o.prop("disabled",!1),"OK"===a.status?(e.replaceWith(a.comment),t.find(".field__textarea").val("").removeClass("error value"),t.find("label.error").remove(),t.parent().hide(),i=null):alert(a.message?a.message:"Случилась непредвиденная ошибка.")}).fail(function(e){o.prop("disabled",!1);var s=$.parseJSON(e.responseText);"ERROR"===s.status&&s.errors?(a.addClass("error"),t.find("label.error").remove(),$('<label class="error">'+s.errors[Object.keys(s.errors)[0]]+"</label>").insertAfter(a)):alert(s.message?s.message:"Случилась непредвиденная ошибка.")})})}),$(document).on("click",".item-step__comments a.comment-delete",function(e){e.preventDefault();var t=$(this).closest(".comments__item");t.closest(".comments__items");let a=$(this).closest(".comment-block").data("child-comment-id"),s=$(this).closest(".comments__items").find("[data-comment-id="+a+"]");confirm("Вы действительно хотите удалить свой комментарий?")&&$.delete(t.data("delete-url")).done(function(e){if("OK"===e.status){if(t.remove(),"step-7-gratitude"===window.location.href.split("/")[3])window.location.reload();else{let t=s.find(".comment__bottom"),a='<div class="comment__icons"><a class="comment__icon comment-edit" href="javascript:void(0);" title="Редактировать свой комментарий">\n                        <svg class="icon icon-edit"><use xlink:href="/assets/img/spritesvg.svg#edit"></use></svg>\n                    </a><a class="comment__icon comment-delete" href="javascript:void(0);" title="Удалить свой комментарий">\n                        <svg class="icon icon-delete"><use xlink:href="/assets/img/spritesvg.svg#delete"></use></svg>\n                    </a></div>';if($("#report-"+s.data("comment-id")+"-comments").children().length<=0&&!$("[data-user-uuid]").data("user-uuid")){t.append(a);let e=$("[data-load-url]").data("loadUrl");s.attr("data-delete-url",e+"/"+s.data("comment-id"))}let o=uuid();$(".comments__amount").text(e.reportsCount);$(".comments").data("store-url");if(0===$("[data-comment-id="+s.data("comment-id")+"]").length){$(".js-form-report").find(".report-form").show()}}}else alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){var t=$.parseJSON(e.responseText);alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),$(".item-step__comments").on("click","a.js-like",function(){var e=$(".item-step__comments"),t=$(this).closest(".comments__item"),a=$(this);$.post(e.data("like-url"),{comment_id:t.data("comment-id")}).done(function(e){"OK"===e.status?(a.toggleClass("active",e.active),a.find("span").text(e.total)):alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){var t=$.parseJSON(e.responseText);"ERROR"===t.status&&t.errors?alert(t.errors[Object.keys(t.errors)[0]]):alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),"comment"===window.location.hash.substr(1,7)&&($('a[name="'+window.location.hash.substr(1)+'"]').length||$("html, body").animate({scrollTop:$("a.comments__more").offset().top-100},500));var l=$("form.questionare");l.submit(function(e){e.preventDefault();var t=$('input[type="checkbox"]:checked',l).map(function(){return $(this).data("poll-option")}).get();t.length&&$.post(l.data("poll-url"),{name:l.data("poll-name"),options:t}).done(function(e){"OK"===e.status?(l.find(".questionare__title").html("Спасибо, что помогаете нам <br>стать лучше!"),l.find(".questionare__group").remove(),l.find(".questionare__btn").remove()):alert(e.message?e.message:"Случилась непредвиденная ошибка.")}).fail(function(e){var t=$.parseJSON(e.responseText);alert(t.message?t.message:"Случилась непредвиденная ошибка.")})}),l.find(".questionare__btn").click(function(e){e.preventDefault(),l.submit()})});
